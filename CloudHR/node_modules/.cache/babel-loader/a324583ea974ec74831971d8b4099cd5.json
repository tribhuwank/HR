{"remainingRequest":"E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\node_modules\\babel-loader\\lib\\index.js!E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\src\\store\\modules\\user.js","dependencies":[{"path":"E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\src\\store\\modules\\user.js","mtime":1546537358168},{"path":"E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _Promise from \"E:\\\\Applicatons\\\\TestProjects\\\\vue-cli3.0-vueadmin\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport { login, logout, getInfo } from '@/api/login';\nimport { getToken, setToken, removeToken } from '@/utils/auth';\nvar user = {\n  state: {\n    token: getToken(),\n    name: '',\n    avatar: '',\n    roles: []\n  },\n  mutations: {\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_NAME: function SET_NAME(state, name) {\n      state.name = name;\n    },\n    SET_AVATAR: function SET_AVATAR(state, avatar) {\n      state.avatar = avatar;\n    },\n    SET_ROLES: function SET_ROLES(state, roles) {\n      state.roles = roles;\n    }\n  },\n  actions: {\n    // 登录\n    Login: function Login(_ref, userInfo) {\n      var commit = _ref.commit;\n      var username = userInfo.username.trim();\n      return new _Promise(function (resolve, reject) {\n        login(username, userInfo.password).then(function (response) {\n          var data = response.data;\n          setToken(data.token);\n          commit('SET_TOKEN', data.token);\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 获取用户信息\n    GetInfo: function GetInfo(_ref2) {\n      var commit = _ref2.commit,\n          state = _ref2.state;\n      return new _Promise(function (resolve, reject) {\n        getInfo(state.token).then(function (response) {\n          var data = response.data;\n\n          if (data.roles && data.roles.length > 0) {\n            // 验证返回的roles是否是一个非空数组\n            commit('SET_ROLES', data.roles);\n          } else {\n            reject('getInfo: roles must be a non-null array !');\n          }\n\n          commit('SET_NAME', data.name);\n          commit('SET_AVATAR', data.avatar);\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 登出\n    LogOut: function LogOut(_ref3) {\n      var commit = _ref3.commit,\n          state = _ref3.state;\n      return new _Promise(function (resolve, reject) {\n        logout(state.token).then(function () {\n          commit('SET_TOKEN', '');\n          commit('SET_ROLES', []);\n          removeToken();\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n    // 前端 登出\n    FedLogOut: function FedLogOut(_ref4) {\n      var commit = _ref4.commit;\n      return new _Promise(function (resolve) {\n        commit('SET_TOKEN', '');\n        removeToken();\n        resolve();\n      });\n    }\n  }\n};\nexport default user;",{"version":3,"sources":["E:\\Applicatons\\TestProjects\\vue-cli3.0-vueadmin\\src\\store\\modules\\user.js"],"names":["login","logout","getInfo","getToken","setToken","removeToken","user","state","token","name","avatar","roles","mutations","SET_TOKEN","SET_NAME","SET_AVATAR","SET_ROLES","actions","Login","userInfo","commit","username","trim","resolve","reject","password","then","response","data","catch","error","GetInfo","length","LogOut","FedLogOut"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '@/api/login'\r\nimport { getToken, setToken, removeToken } from '@/utils/auth'\r\n\r\nconst user = {\r\n  state: {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    roles: []\r\n  },\r\n\r\n  mutations: {\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    // 登录\r\n    Login({ commit }, userInfo) {\r\n      const username = userInfo.username.trim()\r\n      return new Promise((resolve, reject) => {\r\n        login(username, userInfo.password).then(response => {\r\n          const data = response.data;\r\n          setToken(data.token)\r\n          commit('SET_TOKEN', data.token);\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getInfo(state.token).then(response => {\r\n          const data = response.data\r\n          if (data.roles && data.roles.length > 0) { // 验证返回的roles是否是一个非空数组\r\n            commit('SET_ROLES', data.roles)\r\n          } else {\r\n            reject('getInfo: roles must be a non-null array !')\r\n          }\r\n          commit('SET_NAME', data.name)\r\n          commit('SET_AVATAR', data.avatar)\r\n          resolve(response)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 登出\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default user\r\n"]}]}