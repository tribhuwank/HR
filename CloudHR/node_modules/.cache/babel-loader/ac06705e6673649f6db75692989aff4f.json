{"remainingRequest":"E:\\Applicatons\\CloudHR\\CloudHR\\node_modules\\babel-loader\\lib\\index.js!E:\\Applicatons\\CloudHR\\CloudHR\\src\\utils\\request.js","dependencies":[{"path":"E:\\Applicatons\\CloudHR\\CloudHR\\src\\utils\\request.js","mtime":1548582828046},{"path":"E:\\Applicatons\\CloudHR\\CloudHR\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\Applicatons\\CloudHR\\CloudHR\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _Promise from \"E:\\\\Applicatons\\\\CloudHR\\\\CloudHR\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es7.promise.finally\";\nimport axios from 'axios';\nimport { Message, MessageBox } from 'element-ui';\nimport store from '../store';\nimport { getToken } from '@/utils/auth'; // Create an axios instance\n// var BASE_API = '';\n// if (process.env.NODE_ENV == 'production') {\n//     BASE_API = '\"http://193.112.153.155:3001\"';\n// }else{\n//     BASE_API = '\"http://193.112.153.155:3001\"';\n// }\n\nvar service = axios.create({\n  baseURL: \"\",\n  // api like base_url\n  timeout: 500000 // Request timeout\n\n}); // requestInterceptor\n\nservice.interceptors.request.use(function (config) {\n  //   if (store.getters.token) {\n  //     config.headers['X-Token'] = getToken() // Let each request carry a custom token, please modify it according to the actual situation.\n  //   };\n  if (store.getters.token) {\n    config.headers.Authorization = \"Bearer \".concat(getToken());\n  }\n\n  return config;\n}, function (error) {\n  // Do something with request error\n  console.log(error); // for debug\n\n  _Promise.reject(error);\n}); // responeInterceptor\n\nservice.interceptors.response.use(function (response) {\n  /**\r\n  * codeFor non-20000 is a mistake, you can modify your business\r\n  */\n  var res = response.data;\n\n  if (res.code !== 200) {\n    Message({\n      message: res.message,\n      type: 'error',\n      duration: 5 * 1000\n    }); // 50008:Unlawfultoken; 50012:Other clients are logged in;  50014:Token expired;\n\n    if (res.code === 50008 || res.code === 50012 || res.code === 50014) {\n      MessageBox.confirm('You have been logged out，you can cancel to stay on this page，or log in again', 'OK', {\n        confirmButtonText: 're-register',\n        cancelButtonText: 'cancel',\n        type: 'warning'\n      }).then(function () {\n        store.dispatch('FedLogOut').then(function () {\n          location.reload(); // To re-instantiate the vue-router object to avoid bugs\n        });\n      });\n    }\n\n    return _Promise.reject('error');\n  } else {\n    return response.data;\n  }\n}, function (error) {\n  console.log('err' + error); // for debug\n\n  Message({\n    message: error.message,\n    type: 'error',\n    duration: 5 * 1000\n  });\n  return _Promise.reject(error);\n});\nexport default service;",{"version":3,"sources":["E:\\Applicatons\\CloudHR\\CloudHR\\src\\utils\\request.js"],"names":["axios","Message","MessageBox","store","getToken","service","create","baseURL","timeout","interceptors","request","use","config","getters","token","headers","Authorization","error","console","log","reject","response","res","data","code","message","type","duration","confirm","confirmButtonText","cancelButtonText","then","dispatch","location","reload"],"mappings":";;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,EAAkBC,UAAlB,QAAoC,YAApC;AACA,OAAOC,KAAP,MAAkB,UAAlB;AACA,SAASC,QAAT,QAAyB,cAAzB,C,CAEA;AAGA;AACA;AACA;AACA;AACA;AACA;;AACA,IAAMC,OAAO,GAAGL,KAAK,CAACM,MAAN,CAAa;AACzBC,EAAAA,OAAO,EAAE,EADgB;AACZ;AACbC,EAAAA,OAAO,EAAE,MAFgB,CAET;;AAFS,CAAb,CAAhB,C,CAKA;;AACAH,OAAO,CAACI,YAAR,CAAqBC,OAArB,CAA6BC,GAA7B,CAAiC,UAAAC,MAAM,EAAI;AACvC;AACA;AACA;AACA,MAAIT,KAAK,CAACU,OAAN,CAAcC,KAAlB,EAAyB;AACrBF,IAAAA,MAAM,CAACG,OAAP,CAAeC,aAAf,oBAAyCZ,QAAQ,EAAjD;AACH;;AACD,SAAOQ,MAAP;AACH,CARD,EAQG,UAAAK,KAAK,EAAI;AACR;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,EAFQ,CAEW;;AACnB,WAAQG,MAAR,CAAeH,KAAf;AACH,CAZD,E,CAcA;;AACAZ,OAAO,CAACI,YAAR,CAAqBY,QAArB,CAA8BV,GAA9B,CACI,UAAAU,QAAQ,EAAI;AACR;;;AAGA,MAAMC,GAAG,GAAGD,QAAQ,CAACE,IAArB;;AACA,MAAID,GAAG,CAACE,IAAJ,KAAa,GAAjB,EAAsB;AAClBvB,IAAAA,OAAO,CAAC;AACJwB,MAAAA,OAAO,EAAEH,GAAG,CAACG,OADT;AAEJC,MAAAA,IAAI,EAAE,OAFF;AAGJC,MAAAA,QAAQ,EAAE,IAAI;AAHV,KAAD,CAAP,CADkB,CAOlB;;AACA,QAAIL,GAAG,CAACE,IAAJ,KAAa,KAAb,IAAsBF,GAAG,CAACE,IAAJ,KAAa,KAAnC,IAA4CF,GAAG,CAACE,IAAJ,KAAa,KAA7D,EAAoE;AAChEtB,MAAAA,UAAU,CAAC0B,OAAX,CAAmB,8EAAnB,EAAmG,IAAnG,EAAyG;AACrGC,QAAAA,iBAAiB,EAAE,aADkF;AAErGC,QAAAA,gBAAgB,EAAE,QAFmF;AAGrGJ,QAAAA,IAAI,EAAE;AAH+F,OAAzG,EAIGK,IAJH,CAIQ,YAAM;AACV5B,QAAAA,KAAK,CAAC6B,QAAN,CAAe,WAAf,EAA4BD,IAA5B,CAAiC,YAAM;AACnCE,UAAAA,QAAQ,CAACC,MAAT,GADmC,CAClB;AACpB,SAFD;AAGH,OARD;AASH;;AACD,WAAO,SAAQd,MAAR,CAAe,OAAf,CAAP;AACH,GApBD,MAoBO;AACH,WAAOC,QAAQ,CAACE,IAAhB;AACH;AACJ,CA7BL,EA8BI,UAAAN,KAAK,EAAI;AACLC,EAAAA,OAAO,CAACC,GAAR,CAAY,QAAQF,KAApB,EADK,CACqB;;AAC1BhB,EAAAA,OAAO,CAAC;AACJwB,IAAAA,OAAO,EAAER,KAAK,CAACQ,OADX;AAEJC,IAAAA,IAAI,EAAE,OAFF;AAGJC,IAAAA,QAAQ,EAAE,IAAI;AAHV,GAAD,CAAP;AAKA,SAAO,SAAQP,MAAR,CAAeH,KAAf,CAAP;AACH,CAtCL;AAyCA,eAAeZ,OAAf","sourcesContent":["import axios from 'axios'\r\nimport { Message, MessageBox } from 'element-ui'\r\nimport store from '../store'\r\nimport { getToken } from '@/utils/auth'\r\n\r\n// Create an axios instance\r\n\r\n\r\n// var BASE_API = '';\r\n// if (process.env.NODE_ENV == 'production') {\r\n//     BASE_API = '\"http://193.112.153.155:3001\"';\r\n// }else{\r\n//     BASE_API = '\"http://193.112.153.155:3001\"';\r\n// }\r\nconst service = axios.create({\r\n    baseURL: \"\", // api like base_url\r\n    timeout: 500000 // Request timeout\r\n})\r\n\r\n// requestInterceptor\r\nservice.interceptors.request.use(config => {\r\n    //   if (store.getters.token) {\r\n    //     config.headers['X-Token'] = getToken() // Let each request carry a custom token, please modify it according to the actual situation.\r\n    //   };\r\n    if (store.getters.token) {\r\n        config.headers.Authorization = `Bearer ${getToken()}`;\r\n    }\r\n    return config\r\n}, error => {\r\n    // Do something with request error\r\n    console.log(error) // for debug\r\n    Promise.reject(error)\r\n})\r\n\r\n// responeInterceptor\r\nservice.interceptors.response.use(\r\n    response => {\r\n        /**\r\n        * codeFor non-20000 is a mistake, you can modify your business\r\n        */\r\n        const res = response.data\r\n        if (res.code !== 200) {\r\n            Message({\r\n                message: res.message,\r\n                type: 'error',\r\n                duration: 5 * 1000\r\n            })\r\n\r\n            // 50008:Unlawfultoken; 50012:Other clients are logged in;  50014:Token expired;\r\n            if (res.code === 50008 || res.code === 50012 || res.code === 50014) {\r\n                MessageBox.confirm('You have been logged out，you can cancel to stay on this page，or log in again', 'OK', {\r\n                    confirmButtonText: 're-register',\r\n                    cancelButtonText: 'cancel',\r\n                    type: 'warning'\r\n                }).then(() => {\r\n                    store.dispatch('FedLogOut').then(() => {\r\n                        location.reload()// To re-instantiate the vue-router object to avoid bugs\r\n                    })\r\n                })\r\n            }\r\n            return Promise.reject('error')\r\n        } else {\r\n            return response.data\r\n        }\r\n    },\r\n    error => {\r\n        console.log('err' + error)// for debug\r\n        Message({\r\n            message: error.message,\r\n            type: 'error',\r\n            duration: 5 * 1000\r\n        })\r\n        return Promise.reject(error)\r\n    }\r\n)\r\n\r\nexport default service\r\n"]}]}